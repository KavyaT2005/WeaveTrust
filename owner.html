<!DOCTYPE html>
<html>
<head>
<title>Owner Dashboard</title>

<style>
body{
    margin:0;
    background:#f4f6f9;
    font-family:Arial, sans-serif;
}

.top{
    background:#3b73d1;
    color:white;
    padding:16px 24px;
    font-size:18px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.container{
    display:flex;
    gap:30px;
    padding:30px;
    align-items:flex-start;
}

/* ---------- CREATE ORDER CARD ---------- */
.card{
    width:320px;
    background:white;
    padding:25px;
    border-radius:12px;
    box-shadow:0 6px 16px rgba(0,0,0,0.1);
}

.card h3{
    margin-top:0;
    margin-bottom:20px;
}

input{
    width:100%;
    padding:10px;
    margin-bottom:12px;
    border:1px solid #ccc;
    border-radius:6px;
}

button{
    width:100%;
    padding:12px;
    background:#3b73d1;
    color:white;
    border:none;
    border-radius:6px;
    font-weight:bold;
    cursor:pointer;
}

/* ---------- RIGHT SECTION ---------- */
.right{
    flex:1;
}

/* ---------- SEARCH ---------- */
.search-box{
    margin-bottom:20px;
}

.search-box input{
    width:100%;
    padding:12px;
    border-radius:8px;
    border:1px solid #ccc;
    font-size:15px;
}

/* ---------- TABLE ---------- */
.table-card{
    background:white;
    border-radius:12px;
    box-shadow:0 6px 16px rgba(0,0,0,0.1);
    padding:20px;
}

table{
    width:100%;
    border-collapse:collapse;
}

th, td{
    padding:12px;
    border-bottom:1px solid #eee;
    text-align:left;
}

th{
    background:#f1f4f8;
}

.badge{
    padding:6px 12px;
    border-radius:20px;
    font-size:13px;
}

.active{
    background:#ffe9b3;
    color:#8a5a00;
}

.completed{
    background:#d4f4dd;
    color:#187a3c;
}

a{
    text-decoration:none;
    font-weight:bold;
    color:#3b73d1;
}
</style>
</head>

<body>

<div class="top">
    Owner Dashboard | {{ session.user }}
    <a href="/logout" style="color:white">Logout</a>
</div>

<div class="container">

    <!-- ðŸ”¹ LEFT : CREATE ORDER -->
    <div class="card">
        <h3>Create Order</h3>
        <form method="post">
            <input name="weaver" placeholder="Weaver name" required>
            <input name="cloth" placeholder="Cloth type" required>
            <input name="meters" placeholder="Total meters" required>
            <input name="rate" placeholder="Rate per meter" required>
            <button>Create Order</button>
        </form>
    </div>

    <!-- ðŸ”¹ RIGHT : SEARCH + CONNECTED WEAVERS -->
    <div class="right">

        <div class="search-box">
            <input
                type="text"
                placeholder="Search weaver name or phone"
                onkeyup="searchWeaver(this.value)">
        </div>

        <div class="table-card">
            <h3>Connected Weavers</h3>

            <table id="weaverTable">
                <tr>
                    <th>Weaver</th>
                    <th>Phone</th>
                    <th>Status</th>
                    <th>Orders</th>
                </tr>

                {% for w in weavers %}
                <tr>
                    <td>{{ w.weaver }}</td>
                    <td>{{ w.phone or "â€”" }}</td>
                    <td>
                        {% if w.active %}
                            <span class="badge active">Active</span>
                        {% else %}
                            <span class="badge completed">Completed</span>
                        {% endif %}
                    </td>
                    <td>
                        <!-- âœ… CORRECT LINK -->
                        <a href="/owner/weaver/{{ w.weaver }}">View</a>
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>

    </div>
</div>

<!-- ðŸ”¹ SEARCH SCRIPT -->
<script>
function searchWeaver(value){
    value = value.toLowerCase();
    let rows = document.querySelectorAll("#weaverTable tr");

    rows.forEach((row, index)=>{
        if(index === 0) return;
        row.style.display = row.innerText.toLowerCase().includes(value)
            ? "" : "none";
    });
}
</script>

</body>
</html>
